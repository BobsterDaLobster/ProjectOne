<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Profile with Calendar, News, and Game</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #add8e6, #ffd580);
      margin: 0;
      padding: 0;
      color: #333;
    }
    header {
      text-align: center;
      padding: 1rem;
      background: #87cefa;
      color: white;
    }
    .calendar-container { display: flex; }
    .calendar { flex: 2; display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; }
    .calendar div { padding: 10px; background: white; text-align: center; border-radius: 4px; cursor: pointer; }
    .calendar .today { background: #ffd580; font-weight: bold; }
    .event-panel { flex: 1; margin-left: 20px; background: #fff; border-radius: 8px; padding: 10px; }
    .event-panel ul { list-style: none; padding: 0; }
    .event-panel li { margin-bottom: 5px; }
    canvas { background: #eee; display: block; margin: 0 auto; border: 2px solid #333; }
    .news-section { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; }
    .news-article { background: white; padding: 10px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .secret-button { position: fixed; bottom: 5px; right: 5px; width: 15px; height: 15px; background: transparent; border: none; cursor: pointer; }
    #keypad { text-align: center; margin-top: 10px; }
    .key { display: inline-block; width: 40px; height: 40px; line-height: 40px; margin: 5px; background: #87cefa; color: white; border-radius: 8px; cursor: pointer; font-weight: bold; }
  </style>
</head>
<body>
  <header><h1>My Personal Profile</h1></header>

  <section>
    <h2>Calendar</h2>
    <div class="calendar-container">
      <div class="calendar" id="calendar"></div>
      <div class="event-panel">
        <h3 id="selectedDate"></h3>
        <ul id="eventList"></ul>
        <input type="text" id="newEvent" placeholder="New Event" />
        <button onclick="addEvent()">Add</button>
      </div>
    </div>
  </section>

  <section>
    <h2>World News</h2>
    <div id="news" class="news-section"></div>
  </section>

  <section>
    <h2>Mini-Game: Crossy Road Clone</h2>
    <canvas id="gameCanvas" width="400" height="560"></canvas>
    <div id="keypad">
      <div class="key" onclick="move('up')">↑</div><br>
      <div class="key" onclick="move('left')">←</div>
      <div class="key" onclick="move('down')">↓</div>
      <div class="key" onclick="move('right')">→</div>
    </div>
  </section>

  <button class="secret-button" onclick="redirectSecret()"></button>

  <script>
    // ===== Calendar =====
    const calendarEl = document.getElementById('calendar');
    const selectedDateEl = document.getElementById('selectedDate');
    const eventListEl = document.getElementById('eventList');
    let currentDate = new Date();
    let events = JSON.parse(localStorage.getItem('events') || '{}');

    function renderCalendar() {
      calendarEl.innerHTML = '';
      const year = currentDate.getFullYear();
      const month = currentDate.getMonth();
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      for (let d = 1; d <= daysInMonth; d++) {
        const cell = document.createElement('div');
        cell.textContent = d;
        if (d === new Date().getDate() && month === new Date().getMonth()) cell.classList.add('today');
        cell.onclick = () => loadEvents(new Date(year, month, d));
        calendarEl.appendChild(cell);
      }
    }
    function loadEvents(date) {
      const key = date.toDateString();
      selectedDateEl.textContent = key;
      eventListEl.innerHTML = '';
      (events[key] || []).forEach((e, i) => {
        const li = document.createElement('li');
        li.textContent = e;
        li.onclick = () => { events[key].splice(i,1); localStorage.setItem('events', JSON.stringify(events)); loadEvents(date); };
        eventListEl.appendChild(li);
      });
      selectedDateEl.dataset.date = key;
    }
    function addEvent() {
      const key = selectedDateEl.dataset.date;
      if (!events[key]) events[key] = [];
      const val = document.getElementById('newEvent').value;
      if (val) { events[key].push(val); localStorage.setItem('events', JSON.stringify(events)); loadEvents(new Date(key)); }
    }
    renderCalendar();

    // ===== News =====
    async function fetchNews() {
      const res = await fetch("https://api.rss2json.com/v1/api.json?rss_url=https://news.google.com/rss?hl=en-US&gl=US&ceid=US:en");
      const data = await res.json();
      const container = document.getElementById("news");
      container.innerHTML = "";
      data.items.slice(0,6).forEach(article => {
        const div = document.createElement("div");
        div.className = "news-article";
        div.innerHTML = `<h4><a href="${article.link}" target="_blank">${article.title}</a></h4>
          ${article.thumbnail ? `<img src="${article.thumbnail}">` : ""}
          <p>${article.description || ""}</p>`;
        container.appendChild(div);
      });
    }
    fetchNews(); setInterval(fetchNews, 1800000);

    // ===== Secret Code =====
    function redirectSecret() {
      const code = prompt("Enter secret code:");
      if (code === "494849") window.location.href = "https://poki.com";
    }

    // ===== Game =====
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const TILE = 20;
    let player, lanes;

    function resetGame() {
      player = { x: 10*TILE, y: 26*TILE, size: TILE };
      lanes = [];
      for (let i = 0; i < 28; i++) {
        if (i % 8 === 0) lanes.push({type:'safe', entities:[]});
        else if (Math.random()<0.4) lanes.push({type:'road', entities:[{x:0,y:i*TILE,speed:2}]});
        else if (Math.random()<0.6) lanes.push({type:'river', entities:[{x:0,y:i*TILE,speed:1}]});
        else lanes.push({type:'grass', entities:[]});
      }
    }

    function move(dir) {
      if (dir==='up') player.y -= TILE;
      if (dir==='down') player.y += TILE;
      if (dir==='left') player.x -= TILE;
      if (dir==='right') player.x += TILE;
      player.x = Math.max(0, Math.min(canvas.width - TILE, player.x));
      player.y = Math.max(0, Math.min(canvas.height - TILE, player.y));
    }

    function gameLoop() {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      lanes.forEach((lane,i)=>{
        const y=i*TILE;
        if(lane.type==='road'){
          ctx.fillStyle='gray'; ctx.fillRect(0,y,canvas.width,TILE);
          lane.entities.forEach(car=>{
            car.x+=car.speed;
            if(car.x>canvas.width) car.x=-40;
            ctx.fillStyle='red'; ctx.fillRect(car.x,y,TILE,TILE);
            if(player.x<car.x+TILE && player.x+TILE>car.x && player.y===y) resetGame();
          });
        } else if(lane.type==='river'){
          ctx.fillStyle='blue'; ctx.fillRect(0,y,canvas.width,TILE);
          let onLog=false;
          lane.entities.forEach(log=>{
            log.x+=log.speed;
            if(log.x>canvas.width) log.x=-60;
            ctx.fillStyle='brown'; ctx.fillRect(log.x,y,TILE*3,TILE);
            if(player.x<log.x+TILE*3 && player.x+TILE>log.x && player.y===y){
              onLog=true; player.x+=log.speed;
            }
          });
          if(player.y===y && !onLog) resetGame();
        } else {
          ctx.fillStyle='green'; ctx.fillRect(0,y,canvas.width,TILE);
        }
      });
      ctx.fillStyle='yellow'; ctx.fillRect(player.x,player.y,player.size,player.size);
      requestAnimationFrame(gameLoop);
    }

    resetGame();
    gameLoop();
  </script>
</body>
</html>
